# AGB Passports

Система создания и управления паспортами алмазного инструмента для ООО "Алмазгеобур".

## Описание

AGB Passports - это веб-приложение для создания, управления и экспорта паспортов алмазного инструмента. Система включает в себя:

- **Авторизацию пользователей** с ролевой моделью (администратор/пользователь)
- **Создание паспортов** с уникальными номерами
- **Управление номенклатурой** алмазного инструмента
- **Экспорт в Excel** (.xlsx) и **PDF** форматы
- **Архив паспортов** с возможностью просмотра истории

## Технологии

### Backend
- **FastAPI** - современный веб-фреймворк для Python
- **PostgreSQL** - реляционная база данных
- **SQLAlchemy** - ORM для работы с базой данных
- **Pydantic** - валидация данных
- **JWT** - аутентификация
- **ReportLab** - генерация PDF документов

### Frontend
- **Next.js** - React фреймворк
- **TypeScript** - типизированный JavaScript
- **Tailwind CSS** - CSS фреймворк
- **React Hook Form** - управление формами
- **Axios** - HTTP клиент
- **React Hot Toast** - уведомления

### Инфраструктура
- **Docker** - контейнеризация
- **Docker Compose** - оркестрация контейнеров

## Установка и запуск

### Предварительные требования
- Docker и Docker Compose
- Git

### Клонирование репозитория
```bash
git clone https://github.com/Garanash/agb_passports.git
cd agb_passports
```

### Запуск приложения
```bash
# Запуск всех сервисов
docker-compose up -d

# Создание администратора и загрузка номенклатуры
python setup_and_run.py
```

### Доступ к приложению
- **Фронтенд:** http://localhost:3001
- **API:** http://localhost:8000
- **Документация API:** http://localhost:8000/docs

## Тестовые аккаунты

- **Администратор:** `admin` / `admin123`
- **Пользователь:** `demo_user` / `demo123`

## Функциональность

### Для администраторов
- Создание и управление пользователями
- Просмотр всех паспортов в системе
- Доступ к архиву всех паспортов

### Для пользователей
- Создание паспортов с уникальными номерами
- Просмотр только своих созданных паспортов
- Экспорт паспортов в Excel и PDF форматы

### Создание паспортов
1. Введите номер заказа (минимум 6 символов)
2. Выберите номенклатуру из базы данных
3. Укажите количество паспортов для каждой номенклатуры
4. Нажмите "Создать паспорта"
5. Экспортируйте результаты в Excel или PDF

### Экспорт
- **Excel (.xlsx):** Список всех созданных паспортов с детальной информацией
- **PDF:** Профессиональные паспорта в печатной форме (3 паспорта на страницу)

## Структура проекта

```
agb_passports/
├── backend/                 # Backend приложение (FastAPI)
│   ├── api/                # API эндпоинты
│   ├── models.py           # Модели базы данных
│   ├── schemas.py          # Pydantic схемы
│   ├── auth.py             # Аутентификация
│   └── utils/              # Утилиты (PDF генератор)
├── frontend/               # Frontend приложение (Next.js)
│   ├── components/         # React компоненты
│   ├── hooks/             # Custom hooks
│   ├── contexts/           # React контексты
│   └── pages/             # Страницы
├── docker-compose.yml     # Конфигурация Docker
├── Dockerfile.backend     # Dockerfile для backend
├── Dockerfile.frontend    # Dockerfile для frontend
└── requirements.txt       # Python зависимости
```

## API Endpoints

### Аутентификация
- `POST /api/v1/auth/login` - Вход в систему
- `GET /api/v1/auth/me` - Информация о текущем пользователе

### Паспорта
- `GET /api/v1/passports/` - Получение списка паспортов
- `POST /api/v1/passports/multiple` - Создание множественных паспортов
- `POST /api/v1/passports/export/bulk/pdf` - Экспорт паспортов в PDF

### Номенклатура
- `GET /api/v1/nomenclature/` - Получение списка номенклатуры

### Пользователи (только для администраторов)
- `GET /api/v1/users/` - Получение списка пользователей
- `POST /api/v1/users/` - Создание пользователя
- `PUT /api/v1/users/{user_id}` - Обновление пользователя
- `DELETE /api/v1/users/{user_id}` - Удаление пользователя

## Разработка

### Backend разработка
```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск в режиме разработки
uvicorn backend.main:app --reload --host 0.0.0.0 --port 8000
```

### Frontend разработка
```bash
cd frontend
npm install
npm run dev
```

## Лицензия

Проект разработан для ООО "Алмазгеобур" и предназначен для внутреннего использования.

## Контакты

- **Компания:** ООО "Алмазгеобур"
- **Email:** contact@almazgeobur.ru
- **Телефон:** +7 495 229 82 94
- **Адрес:** 125362, г. Москва, улица Водников, дом 2, стр. 14, оф. 11