# Инструкция по созданию шаблона наклеек

## Как создать шаблон Word для наклеек

### Шаг 1: Создайте документ Word

1. Откройте Microsoft Word
2. Создайте новый документ
3. Установите размер страницы A4 (210 × 297 мм)
4. Установите все поля (отступы) на 0 мм

### Шаг 2: Создайте таблицу для одной наклейки

1. Вставьте таблицу 1×1 (одна ячейка)
2. Установите размер ячейки: **52.5 мм × 148.5 мм**
   - Это размер одной наклейки (1/8 страницы A4)
3. Убедитесь, что отступы ячейки равны 0 мм

### Шаг 3: Добавьте плейсхолдеры в шаблон

В ячейке таблицы используйте следующие плейсхолдеры:

#### Текстовые плейсхолдеры:
- `{{ company_name_ru }}` - Название компании на русском
- `{{ company_name_en }}` - Название компании на английском  
- `{{ nomenclature_name }}` - Название номенклатуры
- `{{ article }}` - Артикул
- `{{ matrix }}` - Типоразмер
- `{{ height }}` - Высота матрицы
- `{{ waterways }}` - Промывочные отверстия
- `{{ serial_number }}` - Серийный номер паспорта
- `{{ production_date }}` - Дата производства (год)
- `{{ order_number }}` - Номер заказа

#### Для логотипа:
Если хотите добавить логотип, вставьте изображение-заглушку в нужное место. Система автоматически заменит его на реальный логотип.

### Шаг 4: Пример шаблона

```
┌─────────────────────────────┐
│                             │
│     [Логотип здесь]         │
│                             │
│ {{ nomenclature_name }}     │
│                             │
│ Артикул: {{ article }}     │
│ Типоразмер: {{ matrix }}    │
│ Высота: {{ height }} мм     │
│ Промывочные: {{ waterways }}│
│                             │
│ Серийный номер:             │
│ {{ serial_number }}         │
│                             │
│ Дата: {{ production_date }} │
│                             │
└─────────────────────────────┘
```

### Шаг 5: Сохраните шаблон

1. Сохраните файл как `sticker_template.docx`
2. Поместите его в одну из следующих директорий:
   - `backend/utils/templates/sticker_template.docx` (предпочтительно)
   - `templates/sticker_template.docx`
   - На сервере: `/root/agb_passports/templates/sticker_template.docx`

### Шаг 6: Проверка работы

1. После размещения шаблона система автоматически начнет его использовать
2. При экспорте наклеек система:
   - Найдет шаблон
   - Подставит данные из паспортов
   - Разместит 8 наклеек на странице (2 ряда × 4 колонки)
   - Сгенерирует DOCX файл

### Важные замечания

- **Размер ячейки критичен**: 52.5 × 148.5 мм
- **Отступы должны быть 0 мм** везде
- **Плейсхолдеры** пишутся в формате `{{ переменная }}`
- Если шаблон не найден, система использует стандартный метод генерации
- Можно использовать форматирование текста (жирный, курсив, размер шрифта)

### Поддержка

Если шаблон не работает:
1. Проверьте путь к файлу
2. Проверьте формат плейсхолдеров
3. Проверьте размеры ячейки
4. Посмотрите логи backend контейнера: `docker logs agb_backend`
