import { useAuth } from '../contexts/AuthContext'
import { ArrowRightOnRectangleIcon, UserCircleIcon } from '@heroicons/react/24/outline'
import { useRouter } from 'next/router'

export default function Layout({ children }: { children: React.ReactNode }) {
  const { user, logout } = useAuth()
  const router = useRouter()

  const handleLogout = () => {
    logout()
    router.push('/login')
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Простая верхняя панель только с выходом */}
      <div className="bg-white shadow-sm border-b border-gray-200">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center space-x-3">
              <div className="flex items-center">
                <svg width="60" height="18" viewBox="0 0 180 53" fill="none" xmlns="http://www.w3.org/2000/svg" className="text-[#FBBA00]">
                  <g clip-path="url(#clip0_791_2649)">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M28.316 0C32.3097 0.364122 36.0417 1.65878 39.3096 3.66651C39.0776 4.03569 38.9443 4.48072 38.9443 4.95105C38.9443 6.27605 39.9958 7.35324 41.2892 7.35324C42.0099 7.35324 42.6566 7.01946 43.0861 6.49351C45.9739 9.08788 48.299 12.3346 49.8392 16.0011C48.9753 16.3552 48.3583 17.2199 48.3583 18.2314C48.3583 19.5564 49.4097 20.6336 50.7031 20.6336C50.9055 20.6336 51.103 20.6083 51.2906 20.5577C51.7151 22.4694 51.9422 24.4569 51.9422 26.5C51.9422 28.5431 51.725 30.4548 51.3152 32.3361C51.1178 32.2804 50.9104 32.2501 50.6932 32.2501C49.3999 32.2501 48.3484 33.3273 48.3484 34.6523C48.3484 35.684 48.9852 36.5639 49.8787 36.9028C48.3484 40.5946 46.0233 43.8565 43.1305 46.466C42.701 45.8996 42.0297 45.5304 41.2744 45.5304C39.981 45.5304 38.9295 46.6076 38.9295 47.9326C38.9295 48.4434 39.0826 48.9137 39.3491 49.3031C36.0713 51.326 32.3195 52.6308 28.3062 53C28.3062 51.6801 27.2547 50.6079 25.9613 50.6079C24.668 50.6079 23.6214 51.68 23.6165 53.0051C19.6475 52.6409 15.9353 51.3614 12.6821 49.3739C12.9734 48.9744 13.1461 48.4738 13.1461 47.9377C13.1461 46.6127 12.0947 45.5355 10.8013 45.5355C10.0115 45.5355 9.31047 45.935 8.88593 46.552C5.95858 43.9374 3.61374 40.6552 2.06368 36.9432C3.02136 36.6398 3.71741 35.7295 3.71741 34.6472C3.71741 33.3222 2.66593 32.245 1.37256 32.245C1.11093 32.245 0.854231 32.2906 0.617279 32.3715C0.202612 30.4801 -0.0195312 28.5178 -0.0195312 26.4949C-0.0195312 24.472 0.207548 22.434 0.641961 20.5072C0.873977 20.583 1.11587 20.6235 1.37256 20.6235C2.66593 20.6235 3.71741 19.5513 3.71741 18.2213C3.71741 17.1593 3.04111 16.254 2.10317 15.9405C3.65817 12.2537 6.00795 8.99685 8.93036 6.39742C9.35984 6.97395 10.0361 7.34313 10.7964 7.34313C12.0897 7.34313 13.1412 6.27099 13.1412 4.94094C13.1412 4.44027 12.9882 3.96994 12.7315 3.58559C15.9896 1.62844 19.6821 0.359065 23.6313 0C23.6807 1.28454 24.7075 2.30611 25.9712 2.30611C27.2349 2.30611 28.2667 1.28454 28.316 0ZM25.9712 3.45916C13.5509 3.45916 3.48539 13.776 3.48539 26.5C3.48539 39.224 13.5559 49.5408 25.9761 49.5408C38.3964 49.5408 48.4669 39.224 48.4669 26.5C48.4669 13.776 38.3915 3.45916 25.9712 3.45916Z" fill="currentColor"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M40.2478 10.6152C40.8994 10.6355 41.1956 10.9187 41.5511 11.4547L48.3931 21.0433L25.9665 49.7988L3.5498 21.0433L10.3918 11.4547C10.7472 10.9187 11.0434 10.6355 11.695 10.6152C21.2126 10.6152 30.7302 10.6152 40.2478 10.6152ZM17.6386 21.7108H6.76841C6.31425 21.7007 6.0773 22.2419 6.36362 22.5857L22.896 43.6138C23.2366 44.069 23.9475 43.7149 23.8092 43.1586L18.1174 22.075C18.0533 21.8676 17.8608 21.7159 17.6386 21.7058V21.7108ZM34.2105 21.7108C33.9883 21.7159 33.7958 21.8676 33.7316 22.08L28.0398 43.1637C27.8967 43.72 28.6125 44.074 28.9531 43.6189L45.4855 22.5857C45.7767 22.2419 45.5348 21.7007 45.0807 21.7108H34.2105ZM31.6237 21.7108H20.2796C19.9341 21.7108 19.6823 22.0547 19.7811 22.3936L25.4778 43.4419C25.6209 43.9526 26.3318 43.9526 26.475 43.4419L32.1322 22.3936C32.2063 22.1104 31.9101 21.7159 31.6237 21.7159V21.7108ZM16.6316 19.3896L11.8876 12.6634C11.7987 12.542 11.6457 12.4611 11.4778 12.4611C11.31 12.4611 11.157 12.542 11.0681 12.6634L6.32412 19.3896C6.10198 19.6879 6.334 20.0976 6.72892 20.1026H16.2317C16.6316 20.1026 16.8586 19.6879 16.6365 19.3946L16.6316 19.3896ZM23.8685 12.4207C24.0906 12.1274 23.8685 11.7127 23.4637 11.7127H13.9609C13.566 11.7127 13.334 12.1274 13.5561 12.4257L18.3001 19.1519C18.389 19.2732 18.542 19.3542 18.7098 19.3542C18.8777 19.3542 19.0307 19.2732 19.1196 19.1519L23.8635 12.4257L23.8685 12.4207ZM31.1202 19.3896L26.3762 12.6634C26.2874 12.542 26.1343 12.4611 25.9665 12.4611C25.7987 12.4611 25.6456 12.542 25.5568 12.6634L20.8128 19.3896C20.5906 19.6879 20.8227 20.0976 21.2176 20.1026H30.7204C31.1202 20.1026 31.3473 19.6879 31.1252 19.3946L31.1202 19.3896ZM45.5299 19.4047L40.7859 12.6786C40.6971 12.5572 40.544 12.4763 40.3762 12.4763C40.2083 12.4763 40.0553 12.5572 39.9664 12.6786L35.2225 19.4047C35.0003 19.7031 35.2323 20.1128 35.6273 20.1178H45.13C45.5299 20.1178 45.757 19.7031 45.5348 19.4098L45.5299 19.4047ZM28.0053 12.3954L32.7493 19.1215C32.8381 19.2429 32.9912 19.3238 33.159 19.3238C33.3268 19.3238 33.4799 19.2429 33.5687 19.1215L38.3127 12.3954C38.5349 12.097 38.3028 11.6874 37.9079 11.6823H28.4051C28.0053 11.6823 27.7782 12.097 28.0003 12.3903L28.0053 12.3954Z" fill="currentColor"/>
                  </g>
                  <defs>
                    <clipPath id="clip0_791_2649">
                      <rect width="180" height="53" fill="white"/>
                    </clipPath>
                  </defs>
                </svg>
              </div>
              <h1 className="text-xl font-semibold text-gray-900">AGB Passports</h1>
            </div>
            <div className="flex items-center space-x-4">
              <span className="text-sm text-gray-600">
                {user?.full_name || user?.username}
              </span>
              <button
                onClick={handleLogout}
                className="flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors duration-200"
              >
                <ArrowRightOnRectangleIcon className="h-4 w-4 mr-2" />
                Выйти
              </button>
            </div>
          </div>
        </div>
      </div>

      {/* Основной контент */}
      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {children}
      </main>
    </div>
  )
}
